'use strict';define(["modules/default/defaultview","src/util/datatraversing","src/util/api","src/util/util","lib/flot/jquery.flot","lib/flot/jquery.flot.pie"],function(a,b,c,d){"use strict";function e(){}return $.extend(!0,e.prototype,a,{init:function(){this.dom||(this._id=d.getNextUniqueId(),this.dom=$(`<div id="${this._id}"></div>`).css("height","100%").css("width","100%"),this.module.getDomContent().html(this.dom)),this.dom&&this.dom.empty(),this._flot&&delete this._flot,this.loadedData=$.Deferred(),this.updateOptions(),this._data=[],this.resolveReady()},onResize:function(){var a=this;this.loadedData.done(function(){a._plot=$.plot(`#${a._id}`,a._data,a._options),$(`#${a._id}`).bind("plotclick",function(a,b,c){}),$(`#${a._id}`).bind("plothover",function(b,c,d){d?a.module.controller.elementHover(a._data[d.seriesIndex]):a.module.controller.elementOut()}),c.killHighlight(a.module.getId());for(var b=0;b<a._data.length;b++)a._data[b]._highlight&&function(b){c.listenHighlight(a._data[b],function(c){c?a._plot.highlight(0,b):a._plot.unhighlight(0,b)},!1,a.module.getId())}(b)})},update:{chart:function(a){a&&a.value&&(this._convertChartToData(a.get()),this.loadedData.resolve(),this.onResize())},yArray:function(a){this._data=a.get(),this.loadedData.resolve(),this.onResize()}},_convertChartToData:function(a){this._data=[];var c=this;if(Array.isArray(a.data)&&a.data[0]&&Array.isArray(a.data[0].y)){var d=a.data[0].y,e=a.data[0]._highlight,f=a.data[0].info;for(let a=0;a<d.length;a++)this._data[a]={data:d[a]},Array.isArray(e)&&e.length>a&&(Array.isArray(e[a])?this._data[a]._highlight=e[a]:this._data[a]._highlight=[e[a]]),Array.isArray(f)&&f.length>a&&b.getValueFromJPath(f[a],"element.name").done(function(b){c._data[a].label=b,c._data[a].info=f[a]})}},updateOptions(){this._options={grid:{clickable:!0,hoverable:!0},series:{pie:{show:!0}}},this._options.test=this.module.getConfiguration("nodeSize")||1}}),e});
