'use strict';define(["jquery","modules/default/defaultcontroller","smart-array-filter"],function(a,b,c){"use strict";function d(a){return /^\/.*\/$/.exec(a)}function e(a){return d(a)?new RegExp(a.slice(1,-1)):a}function f(){}const g=c.filter;return a.extend(!0,f.prototype,b),f.prototype.moduleInformation={name:"Smart array filter",description:"Use simple text queries to search in an array of complex objects.",author:"Micha\xEBl Zasso",date:"06.11.2015",license:"MIT",cssClass:"smart_array_filter"},f.prototype.references={input:{label:"Input array",type:"array"},output:{label:"Output array",type:"array"},search:{label:"Search string",type:"string"}},f.prototype.events={onQuery:{label:"Query is changed",refVariable:["output","search"]}},f.prototype.variablesIn=["input"],f.prototype.actionsIn={clearQuery:"Clear current query",setQuery:"Set query",appendQuery:"Append to current query"},f.prototype.configurationStructure=function(){return{groups:{group:{options:{type:"list"},fields:{debounce:{type:"float",title:"Search debouncing (ms)",default:100},limit:{type:"float",title:"Limit output length (0 to disable)",default:0},initialValue:{type:"text",title:"Initial value",default:""},placeholder:{type:"text",title:"Placeholder",default:""},fontSize:{type:"float",title:"Font size",default:20},predicate:{type:"combo",title:"predicate",options:[{title:"AND",key:"AND"},{title:"OR",key:"OR"}],default:"AND"},booleanOptions:{type:"checkbox",title:"Case insensitive",options:{caseInsensitive:"Case insensitive"},default:["caseInsensitive"]}}},aliases:{options:{type:"table",multiple:!0,title:"Aliases"},fields:{alias:{type:"text",title:"Path alias"},pattern:{type:"text",title:"Path or regexp"}}},ignorePaths:{options:{type:"table",multiple:!0,title:"Paths to ignore"},fields:{path:{type:"text",title:"ignored path"}}}}}},f.prototype.configAliases={debounce:["groups","group",0,"debounce",0],limit:["groups","group",0,"limit",0],initialValue:["groups","group",0,"initialValue",0],placeholder:["groups","group",0,"placeholder",0],fontSize:["groups","group",0,"fontSize",0],predicate:["groups","group",0,"predicate",0],booleanOptions:["groups","group",0,"booleanOptions",0],aliases:["groups","aliases",0],ignorePaths:["groups","ignorePaths",0]},f.prototype.onQuery=function(a){if(!this.module.view._data)return;const b=this.module.getConfiguration("aliases",[]).reduce((a,b)=>{if(!b.alias||!b.pattern)return a;const c=e(b.pattern);return a[b.alias]=c,a},{}),c=this.module.getConfiguration("ignorePaths",[]).map(a=>a.path).filter(a=>a).map(e),d={pathAlias:b,caseInsensitive:this.module.getConfigurationCheckbox("booleanOptions","caseInsensitive"),predicate:this.module.getConfiguration("predicate","AND"),keywords:a,index:!0,limit:this.module.getConfiguration("limit",0),ignorePaths:c};for(var f=DataObject.resurrect(this.module.view._data),h=g(f,d),j=this.module.view._originalData,k=Array(h.length),l=0;l<h.length;l++)k[l]=j[h[l]];this.createDataFromEvent("onQuery","search",a),this.createDataFromEvent("onQuery","output",k)},f});
