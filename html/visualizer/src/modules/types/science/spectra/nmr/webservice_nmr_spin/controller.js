'use strict';define(["jquery","modules/default/defaultcontroller","nmr-simulation"],function(a,b,c){"use strict";function d(){}function e(a,b,c){const d=Array(c);for(var e=a,f=0;f<c;f++)d[f]=e,e+=(b-a)/c;return d}a.extend(!0,d.prototype,b),d.prototype.moduleInformation={name:"NMR spin system simulation",description:"Allows to enter coupling constant",author:"Luc Patiny",date:"30.12.2013",license:"MIT",cssClass:"webservice_nmr_spin"};var f=/^delta_(\d+)/;return d.prototype.doAnalysis=function(){var a,b,d,g,h=this.module.view.system.serializeArray(),k=[],l=[],m={};for(d=0;d<h.length;d++){if(isNaN(h[d].value))throw new Error("not a number");a=h[d].name,(b=f.exec(a))&&(k[b[1]]=+h[d].value,l[b[1]]=2)}var n=Array(k.length);for(d=0;d<k.length;d++)for(n[d]=Array(k.length),g=0;g<k.length;g++)n[d][g]=0;for(d=0;d<h.length;d++)a=h[d].name,f.test(a)||((b=/^coupling_(\d+)_(\d+)/.exec(a))?(n[b[1]][b[2]]=+h[d].value,n[b[2]][b[1]]=+h[d].value):m[a]=+h[d].value);var o=new c.SpinSystem(k,n,l),p=c.simulate1D(o,m),q={data:[{x:e(m.from,m.to,m.nbPoints),y:p}]};this.createDataFromEvent("onSearchReturn","results",q)},d.prototype.references={results:{label:"Spectrum"}},d.prototype.events={onSearchReturn:{label:"An analysis has been completed",refVariable:["results"]}},d.prototype.configurationStructure=function(){return{groups:{group:{options:{type:"list"},fields:{systemSize:{type:"combo",title:"Spin system",default:"2",options:[{key:"2",title:"AB"},{key:"3",title:"ABC"},{key:"4",title:"ABCD"},{key:"5",title:"ABCDE"},{key:"6",title:"ABCDEF"},{key:"7",title:"ABCDEFG"},{key:"8",title:"ABCDEFGH"}]},button:{type:"checkbox",title:"Process button",default:"button",options:{button:""}},buttonlabel:{type:"text",default:"Calculate",title:"Button text"},buttonlabel_exec:{type:"text",default:"Calculating",title:"Button text (executing)"},onloadanalysis:{type:"checkbox",title:"Make one process on load",default:"onload",options:{onload:""}}}}}}},d.prototype.configAliases={button:["groups","group",0,"button",0],systemSize:["groups","group",0,"systemSize"],buttonlabel:["groups","group",0,"buttonlabel",0],buttonlabel_exec:["groups","group",0,"buttonlabel_exec",0],onloadanalysis:["groups","group",0,"onloadanalysis",0,0]},d});
