'use strict';define(["jquery","modules/default/defaultcontroller","nmr-simulation"],function(a,b,c){"use strict";function d(){}function e(a,b,c){const d=Array(c);for(var e=a,f=0;f<c;f++)d[f]=e,e+=(b-a)/c;return d}a.extend(!0,d.prototype,b),d.prototype.moduleInformation={name:"NMR spin system simulation",description:"Allows to enter coupling constant",author:"Luc Patiny",date:"30.12.2013",license:"MIT",cssClass:"webservice_nmr_spin"};var f=/^delta_(\d+)/,g=/^coupling_(\d+)_(\d+)/;return d.prototype.doAnalysis=function(){var a,b,d,h,k=this.module.view.system.serializeArray(),l=[],m=[],n={};for(d=0;d<k.length;d++){if(isNaN(k[d].value))throw new Error("not a number");a=k[d].name,(b=f.exec(a))&&(l[b[1]]=+k[d].value,m[b[1]]=2)}var o=Array(l.length);for(d=0;d<l.length;d++)for(o[d]=Array(l.length),h=0;h<l.length;h++)o[d][h]=0;for(d=0;d<k.length;d++)a=k[d].name,f.test(a)||((b=g.exec(a))?(o[b[1]][b[2]]=+k[d].value,o[b[2]][b[1]]=+k[d].value):n[a]=+k[d].value);var p=new c.SpinSystem(l,o,m),q=c.simulate1D(p,n),r={data:[{x:e(n.from,n.to,n.nbPoints),y:q}]};this.createDataFromEvent("onSearchReturn","results",r)},d.prototype.references={results:{label:"Spectrum"}},d.prototype.events={onSearchReturn:{label:"An analysis has been completed",refVariable:["results"]}},d.prototype.configurationStructure=function(){return{groups:{group:{options:{type:"list"},fields:{systemSize:{type:"combo",title:"Spin system",default:"2",options:[{key:"2",title:"AB"},{key:"3",title:"ABC"},{key:"4",title:"ABCD"},{key:"5",title:"ABCDE"},{key:"6",title:"ABCDEF"},{key:"7",title:"ABCDEFG"},{key:"8",title:"ABCDEFGH"}]},button:{type:"checkbox",title:"Process button",default:"button",options:{button:""}},buttonlabel:{type:"text",default:"Calculate",title:"Button text"},buttonlabel_exec:{type:"text",default:"Calculating",title:"Button text (executing)"},onloadanalysis:{type:"checkbox",title:"Make one process on load",default:"onload",options:{onload:""}}}}}}},d.prototype.configAliases={button:["groups","group",0,"button",0],systemSize:["groups","group",0,"systemSize"],buttonlabel:["groups","group",0,"buttonlabel",0],buttonlabel_exec:["groups","group",0,"buttonlabel_exec",0],onloadanalysis:["groups","group",0,"onloadanalysis",0,0]},d});
